{"meta":{"title":"秀恩爱可能不好","subtitle":"","description":"","author":"jilin7105","url":"http://yoursite.com","root":"/"},"pages":[],"posts":[{"title":"聊聊ua","slug":"聊聊ua","date":"2020-08-12T02:55:17.000Z","updated":"2020-08-12T06:49:07.966Z","comments":true,"path":"/","link":"","permalink":"http://yoursite.com/","excerpt":"","text":"User-Agent============= 背景介绍 最近公司在渠道广告推广过程中，遇到了一个问题，就是ip+ua匹配率很低。 之所以匹配率低是因为，我们使用整个ua进行匹配。由于用户手机中不同app使用的浏览器的内核不同，或者不同app增加的ua个性化标示不同，导致ua无法匹配成功。 什么是ua User Agent中文名为用户代理，是Http协议中的一部分，属于头域的组成部分，User Agent也简称UA ua里面有什么 User-Agent: Mozilla/ () () 浏览器标识 (操作系统标识; 加密等级标识; 浏览器语言) 渲染引擎标识版本信息 Mozilla/5.0 (iPhone; CPU iPhone OS 13_5_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.1 Safari/605.1.15 //本人电脑 safari ua Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.105 Safari/537.36 //本人电脑 Chrome ua Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:72.0) Gecko/20100101 Firefox/72.0 //本人电脑 Firefox ua 上面是我们获取到的一个ios手机的ua Mozilla/5.0 是一个通用标记符号，用来表示与 Mozilla 兼容，这几乎是现代浏览器的标配。 platform = AppleWebKit/605.1.15 用来说明浏览器所运行的原生系统平台,也代指渲染引擎，手机内置的浏览器用的就是AppleWebKit为内核开发的浏览器（大部分安卓手机也用使用这个苹果浏览器内核） system-information = (iPhone; CPU iPhone OS 13_5_1 like Mac OS X) 这里包含了 不变的信息 由此我们大体估计出不变的信息为(Macintosh; Intel Mac OS X 10_15_4)这一段，虽然每个浏览器情况可能不一样 其中 Macintosh一般指MAC 也就是平台 Intel Mac OS X 10_15_4 是指 操作系统。 当然这是 苹果手机和浏览器的情况 安卓手机ua查看 123Yidui-Android-Mozilla&#x2F;5.0 (Linux; Android 8.1.0; vivo Y85A Build&#x2F;OPM1.171019.011; wv) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Version&#x2F;4.0 Chrome&#x2F;62.0.3202.84 Mobile Safari&#x2F;537.36Dalvik&#x2F;2.1.0 (Linux; U; Android 8.1.0; vivo Y85A Build&#x2F;OPM1.171019.011) 123Mozilla&#x2F;5.0 (Linux; Android 8.1.0; V1818A Build&#x2F;OPM1.171019.026; wv) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Version&#x2F;4.0 Chrome&#x2F;62.0.3202.84 Mobile Safari&#x2F;537.36Dalvik&#x2F;2.1.0 (Linux; U; Android 8.1.0; V1818A Build&#x2F;OPM1.171019.026) 123Yidui-Android-Mozilla&#x2F;5.0 (Linux; Android 9; HMA-AL00 Build&#x2F;HUAWEIHMA-AL00; wv) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Version&#x2F;4.0 Chrome&#x2F;74.0.3729.136 Mobile Safari&#x2F;537.36Mozilla&#x2F;5.0 (Linux; Android 9; HMA-AL00 Build&#x2F;HUAWEIHMA-AL00; wv) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Version&#x2F;4.0 Chrome&#x2F;75.0.3770.156 Mobile Safari&#x2F;537.36 1234Mozilla&#x2F;5.0 (Linux; Android 6.0; HL2001 Build&#x2F;MRA58K; wv) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Version&#x2F;4.0 Chrome&#x2F;77.0.3865.120 MQQBrowser&#x2F;6.2 TBS&#x2F;045230 Mobile Safari&#x2F;537.36 V1_AND_SQ_8.3.3_1376_YYB_D QQ&#x2F;8.3.3.4515 NetType&#x2F;4G WebP&#x2F;0.3.0 Pixel&#x2F;720 StatusBarHeight&#x2F;49 SimpleUISwitch&#x2F;0 QQTheme&#x2F;1000Mozilla&#x2F;5.0 (Linux; Android 6.0; HL2001 Build&#x2F;MRA58K; wv) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Version&#x2F;4.0 Chrome&#x2F;44.0.2403.119 Mobile Safari&#x2F;537.36 根据查看安卓手机的ua 来看，其同一个设备请求时，其中相同的信息也只有(Linux; Android 6.0; HL2001 Build/MRA58K; wv) 这一部分 定义解决方案 由于全等的匹配率较低，所以预期采取通过ua中，平台信息，操作系统信息，设备编号 三个信息进行匹配提高匹配率 即 例如:Linux == LinuxAndroid 6.0 = Android 6.0HL2001 Build/MRA58K = HL2001 Build/MRA58K 并且ip相同 192.168.0.134 = 192.168.0.134 ，此时定义为同一个设备 奇奇怪怪的知识的补充 KHTML, like Gecko 这个是什么？","categories":[],"tags":[{"name":"网络协议","slug":"网络协议","permalink":"http://yoursite.com/tags/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/"}]},{"title":"公司分享1 -计算机网络","slug":"公司分享1-计算机网络","date":"2020-08-08T15:38:17.000Z","updated":"2020-08-08T16:02:54.980Z","comments":true,"path":"/","link":"","permalink":"http://yoursite.com/","excerpt":"","text":"计算机网络协议 1 总览","categories":[],"tags":[{"name":"计算机网络协议","slug":"计算机网络协议","permalink":"http://yoursite.com/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/"}]}],"categories":[],"tags":[{"name":"网络协议","slug":"网络协议","permalink":"http://yoursite.com/tags/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/"},{"name":"计算机网络协议","slug":"计算机网络协议","permalink":"http://yoursite.com/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/"}]}